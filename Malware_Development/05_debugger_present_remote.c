/*
    Anti-Debugging - Check for RemoteDebugger
    28 Jan 2025
    Eric

    To build: x86_64-w64-mingw32-gcc 05_debugger_present_remote.c -o RemoteDebugCheck.exe -s -ffunction-sections -fdata-sections -Wno-write-strings -fno-exceptions -fmerge-all-constants -static-libstdc++ -static-libgcc
*/
#include <stdio.h>
#include <stdlib.h>
#include <windows.h>

int main() {
  BOOL HasDebugPort = FALSE;
  // Check if a debugger is present
  // https://unprotect.it/technique/checkremotedebuggerpresent/
  if (CheckRemoteDebuggerPresent(GetCurrentProcess(), &HasDebugPort)) {
    MessageBox(NULL, "New Message", "Nothing to see here", MB_OK);
    return 1;  // exit if a debugger is present
  }
  MessageBox(NULL, "Hack", "Hacking mainframe...", MB_OK);
  return 0;
}